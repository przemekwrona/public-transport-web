openapi: 3.0.0
info:
  title: Open Tip Planner API
  description: Open Tip Planner API
  version: 1.0.0
paths:
  /otp/routers/{instance_id}/plan:
    get:
      tags:
        - otp
      summary: Return possible routes generated by OTP engine
      operationId: planTrip
      parameters:
        - name: instance_id
          in: path
          required: true
          schema:
            type: string
          description: Id of OTP router
        - name: fromPlace
          in: query
          required: true
          schema:
            type: string
        - name: toPlace
          in: query
          required: true
          schema:
            type: string
        - name: date
          in: query
          required: true
          schema:
            type: string
        - name: time
          in: query
          required: true
          schema:
            type: string
        - name: mode
          in: query
          required: true
          schema:
            type: string
        - name: maxWalkDistance
          in: query
          required: false
          schema:
            type: number
            format: double
        - name: arriveBy
          in: query
          required: false
          schema:
            type: boolean
        - name: wheelchair
          in: query
          required: false
          schema:
            type: boolean
        - name: local
          in: query
          required: true
          schema:
            type: string
        - name: numItineraries
          in: query
          required: false
          schema:
            type: integer
        - name: showIntermediateStops
          in: query
          required: true
          schema:
            type: boolean
            default: true
        - name: realtime
          in: query
          required: false
          schema:
            type: boolean
        - name: optimize
          in: query
          required: false
          schema:
            type: string
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoutesResponse'
components:
  schemas:
    AgencyAndId:
      type: object
      properties:
        id:
          type: string
        agencyId:
          type: string

    TripPoint:
      type: object
      properties:
        name:
          type: string
        stopId:
          type: string
        lon:
          type: number
          format: double
        lat:
          type: string
          format: double
        arrival:
          type: integer
          format: int64
        departure:
          type: integer
          format: int64
        zoneId:
          type: string
        stopIndex:
          type: integer
        stopSequence:
          type: integer
        orig:
          type: string
        vertexType:
          type: string

    Step:
      type: object
      properties:
        distance:
          type: number
          format: double
        relativeDirection:
          type: string
        streetName:
          type: string
        absoluteDirection:
          type: string
        stayOn:
          type: boolean
        area:
          type: boolean
        bogusName:
          type: boolean
        lon:
          type: number
          format: double
        lat:
          type: number
          format: double
        elevation:
          type: string
#          type: array
#          items:
#            type: object
#            properties:
#              first:
#                type: number
#                format: double
#              second:
#                type: number
#                format: double
    Leg:
      type: object
      properties:
        startTime:
          type: string
        endTime:
          type: string
        departureDelay:
          type: integer
        arrivalDelay:
          type: integer
        realTime:
          type: boolean
        distance:
          type: number
          format: double
        pathway:
          type: boolean
        mode:
          type: string
        route:
          type: string
        routeId:
          type: string
        routeShortName:
          type: string
        routeLongName:
          type: string
        tripId:
          type: string
        headsign:
          type: string
        agencyTimeZoneOffset:
          type: integer
        interlineWithPreviousLeg:
          type: boolean
        from:
          $ref: '#/components/schemas/TripPoint'
        to:
          $ref: '#/components/schemas/TripPoint'
        legGeometry:
          type: object
          properties:
            points:
              type: string
            length:
              type: string
        intermediateStops:
          type: array
          items:
            $ref: '#/components/schemas/TripPoint'
        rentedBike:
          type: boolean
        flexDrtAdvanceBookMin:
          type: integer
        transitLeg:
          type: boolean
        duration:
          type: integer
        steps:
          type: array
          items:
            $ref: '#/components/schemas/Step'
    Itinerary:
      type: object
      properties:
        duration:
          type: integer
        startTime:
          type: string
        endTime:
          type: string
        walkTime:
          type: integer
        transitTime:
          type: integer
        waitingTime:
          type: integer
        walkDistance:
          type: number
          format: double
        walkLimitExceeded:
          type: boolean
        elevationLost:
          type: number
          format: double
        elevationGained:
          type: number
          format: double
        transfers:
          type: integer
        legs:
          type: array
          items:
            $ref: '#/components/schemas/Leg'
        tooSloped:
          type: boolean
    RequestParameters:
      type: object
    TripPlan:
      type: object
      properties:
        date:
          type: string
        from:
          $ref: '#/components/schemas/TripPoint'
        to:
          $ref: '#/components/schemas/TripPoint'
        itineraries:
          type: array
          items:
            $ref: '#/components/schemas/Itinerary'
    DebugOutput:
      type: object
      properties:
        precalculationTime:
          type: string
        pathCalculationTime:
          type: string
        pathTimes:
          type: array
          items:
            type: integer
        renderingTime:
          type: string
        totalTime:
          type: string
        timedOut:
          type: boolean
    ElevationMetadata:
      type: object
      properties:
        ellipsoidToGeoidDifference:
          type: number
          format: double
        geoidElevation:
          type: boolean
    PlannerError:
      type: object
      properties:
        id:
          type: number
          format: integer
        msg:
          type: string
        message:
           type: string
        noPath:
          type: boolean
    RoutesResponse:
      type: object
      properties:
        requestParameters:
          $ref: '#/components/schemas/RequestParameters'
        plan:
          $ref: '#/components/schemas/TripPlan'
        error:
          $ref: '#/components/schemas/PlannerError'
        debugOutput:
          $ref: '#/components/schemas/DebugOutput'
        elevationMetadata:
          $ref: '#/components/schemas/ElevationMetadata'
